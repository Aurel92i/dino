<style>
  #dino-game {
    position: relative;
    width: 100%;
    max-width: 480px;
    height: 260px;
    background: linear-gradient(#cce6ff, #f0f8ff);
    border: 2px solid #333;
    border-radius: 8px;
    overflow: hidden;
    margin: 0 auto;
  }
  .ground {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 40px;
    background: #6b8e23;
  }
  .dino {
    position: absolute;
    left: 40px;
    bottom: 40px;
    width: 40px;
    height: 40px;
    background: #333;
    border-radius: 6px;
  }
  .dino::after {
    content: "";
    position: absolute;
    top: 10px;
    left: 24px;
    width: 8px;
    height: 8px;
    background: #fff;
    border-radius: 50%;
  }
  .cactus {
    position: absolute;
    bottom: 40px;
    right: -40px;
    width: 24px;
    height: 50px;
    background: #2e8b57;
    border-radius: 3px;
  }
  .hud {
    position: absolute;
    top: 8px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,0.8);
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: bold;
  }
  .message {
    position: absolute;
    bottom: 50%;
    left: 50%;
    transform: translate(-50%, 50%);
    background: rgba(255,255,255,0.9);
    padding: 10px 16px;
    border-radius: 6px;
    font-size: 14px;
    text-align: center;
  }
</style>

<div id="dino-game">
  <div class="hud">Niveau <span id="level">1</span> | Score <span id="score">0</span></div>
  <div class="message" id="msg">Tapez l'écran pour sauter</div>
  <div class="ground"></div>
  <div class="dino" id="dino"></div>
</div>

<script>
  const game = document.getElementById("dino-game");
  const dino = document.getElementById("dino");
  const scoreEl = document.getElementById("score");
  const levelEl = document.getElementById("level");
  const msg = document.getElementById("msg");

  let isJumping = false;
  let dinoY = 40;
  let velocityY = 0;
  let gravity = -0.6;
  let score = 0;
  let level = 1;
  let speed = 3;
  let obstacles = [];
  let playing = false;

  function jump() {
    if (!isJumping && playing) {
      velocityY = 12; // saut simple
      isJumping = true;
    }
    if (!playing) {
      startGame();
    }
  }

  function startGame() {
    score = 0;
    level = 1;
    speed = 3;
    obstacles.forEach(o => o.remove());
    obstacles = [];
    msg.style.display = "none";
    playing = true;
    requestAnimationFrame(update);
  }

  function gameOver() {
    playing = false;
    msg.textContent = "Perdu ! Tapez pour rejouer";
    msg.style.display = "block";
  }

  function spawnCactus() {
    const cactus = document.createElement("div");
    cactus.className = "cactus";
    cactus.style.right = "-40px";
    game.appendChild(cactus);
    obstacles.push(cactus);
  }

  function update() {
    if (!playing) return;

    // Update dino
    dinoY += velocityY;
    velocityY += gravity;
    if (dinoY <= 40) {
      dinoY = 40;
      velocityY = 0;
      isJumping = false;
    }
    dino.style.bottom = dinoY + "px";

    // Update obstacles
    obstacles.forEach((cactus, index) => {
      let x = parseInt(cactus.style.right);
      x += speed;
      cactus.style.right = x + "px";

      // Collision
      const dinoRect = dino.getBoundingClientRect();
      const cactusRect = cactus.getBoundingClientRect();
      if (
        dinoRect.right > cactusRect.left &&
        dinoRect.left < cactusRect.right &&
        dinoRect.bottom > cactusRect.top
      ) {
        gameOver();
      }

      // remove off-screen
      if (x > game.offsetWidth + 50) {
        cactus.remove();
        obstacles.splice(index, 1);
        score++;
        scoreEl.textContent = score;

        // Niveaux
        if (score % 5 === 0) {
          level++;
          levelEl.textContent = level;
          speed += 0.5;
        }
      }
    });

    // Spawn cactus aléatoire
    if (Math.random() < 0.02) {
      spawnCactus();
    }

    requestAnimationFrame(update);
  }

  // Contrôles
  game.addEventListener("click", jump);
  document.addEventListener("keydown", e => {
    if (e.code === "Space" || e.code === "ArrowUp") jump();
  });
</script>
